# ===========================================
# Bitrix Development Environment Configuration
# PHP 8.1 + MariaDB 10.11 + Adminer + phpMyAdmin
# ===========================================

# === Project ===
PROJECT=bitrix
SITE_DOMAIN=bitrix.local

# === Data Paths ===
DATA_PATH=./data
BACKUP_PATH=./backups

# === Ports ===
WEB_HTTP_PORT=8080
WEB_HTTPS_PORT=8443
MYSQL_PORT=3306
ADMINER_PORT=8081
PHPMYADMIN_PORT=8082
MAILPIT_SMTP_PORT=1025
MAILPIT_WEB_PORT=8025

# === SSL ===
# Enable HTTPS with self-signed certificate (snakeoil)
ENABLE_SSL=1

# === SMTP / Mailpit ===
# Development (Mailpit): auth=off, tls=off
# Production (Gmail): SMTP_HOST=smtp.gmail.com, SMTP_PORT=587, auth=on, tls=on, tls_starttls=on
# Production (Yandex): SMTP_HOST=smtp.yandex.ru, SMTP_PORT=587, auth=on, tls=on, tls_starttls=on
SMTP_HOST=mailpit
SMTP_PORT=1025
SMTP_EMAIL=noreply@localhost
SMTP_PASSWORD=
SMTP_AUTH=off
SMTP_TLS=off
SMTP_TLS_STARTTLS=off

# === Database ===
MYSQL_DATABASE=bitrix
MYSQL_USER=bitrix
MYSQL_PASSWORD=bitrixpwd
MYSQL_ROOT_PASSWORD=rootpwd

# === PHP ===
PHP_MEMORY_LIMIT=512M
PHP_INI_TYPE=development
# Set to 2 for legacy Bitrix versions (before 2020)
MBSTRING_FUNC_OVERLOAD=0

# === MariaDB InnoDB Tuning ===
# For 4GB RAM host:
#INNODB_BUFFER_POOL_SIZE=2G
#INNODB_BUFFER_POOL_INSTANCES=2
#INNODB_LOG_FILE_SIZE=256M

# For 8GB RAM host (default):
INNODB_BUFFER_POOL_SIZE=4G
INNODB_BUFFER_POOL_INSTANCES=4
INNODB_LOG_FILE_SIZE=512M

# For 16GB+ RAM host:
#INNODB_BUFFER_POOL_SIZE=12G
#INNODB_BUFFER_POOL_INSTANCES=12
#INNODB_LOG_FILE_SIZE=1G

# === File Permissions ===
# File permissions mode on container startup:
# smart - critical files sync, rest in background (recommended)
# sync  - all synchronously (old behavior, slow startup)
# async - all in background (fastest, possible 403 on start)
# skip  - skip entirely (permissions must be set on host)
CHOWN_MODE=smart

# === System ===
TZ=Europe/Moscow
